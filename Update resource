private void handleRejoin(Resource res) {
    LocalDate rejoinDate = res.getStartDate();     // ✅ actual rejoin date
    LocalDate oldEndDate = resourceService.findById1(res.getPsid()).getEndDate();

    int rejoinYear = rejoinDate.getYear();
    int rejoinMonth = rejoinDate.getMonthValue();

    BigDecimal one = BigDecimal.ONE, zero = BigDecimal.ZERO;

    // 1️⃣ Zero-out availability for all teams between oldEndDate and rejoinDate
    resourceService.getAllTeamsForPsid(res.getPsid()).forEach(team -> {
        for (int year = oldEndDate.getYear(); year <= rejoinYear; year++) {
            AvailabilityCompositeId aid = new AvailabilityCompositeId(res.getPsid(), year, team);
            Availability avail = resourceService.getAvailabilityById(aid);
            if (avail != null) {
                resourceService.zeroOutAvailabilityBetween(avail, oldEndDate, rejoinDate);
            }
        }
    });

    // 2️⃣ Current-year availability = 1 only from rejoin month onward
    AvailabilityCompositeId aidCurr = new AvailabilityCompositeId(res.getPsid(), rejoinYear, res.getTeam());
    Availability availCurr = resourceService.createAvailabilityFromMonth(aidCurr, rejoinMonth, one);
    resourceService.addAvailability(availCurr);

    // 3️⃣ Next-year full availability
    AvailabilityCompositeId aidNext = new AvailabilityCompositeId(res.getPsid(), rejoinYear + 1, res.getTeam());
    resourceService.addAvailability(resourceService.createFullAvailability(aidNext, one));

    // 4️⃣ Reset holidays for both years
    for (int y = rejoinYear; y <= rejoinYear + 1; y++) {
        holidayPlannerRepository.save(resourceService.createEmptyHoliday(res.getPsid(), y));
    }

    // 5️⃣ Log the rejoin
    resourceService.addResourceLog(getChangeLog(
        "Resource rejoined: " + res.getPsid() +
        ", Name: " + res.getName() +
        ", Team: " + res.getTeam() +
        ", Effective from: " + rejoinDate
    ));
}
