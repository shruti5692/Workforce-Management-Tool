private void handleRejoin(Resource res) {
    int year = res.getStartDate().getYear();
    int currentYear = LocalDate.now().getYear();
    BigDecimal availVal = BigDecimal.ONE;
    BigDecimal unAvailVal = BigDecimal.ZERO;

    Availability avail1;
    Availability avail2;

    // Logic same as AddResourceFormalities (slightly simplified)
    if (year < currentYear) {
        // Joined earlier in the current financial year
        avail1 = createPartialAvailability(res, currentYear, LocalDate.now().getMonthValue(), availVal, unAvailVal);
        avail2 = createFullAvailability(res, currentYear + 1, availVal);
    } else if (year == currentYear) {
        avail1 = createPartialAvailability(res, year, res.getStartDate().getMonthValue(), availVal, unAvailVal);
        avail2 = createFullAvailability(res, year + 1, availVal);
    } else {
        // Joined next financial year
        avail1 = createEmptyAvailability(res, currentYear, unAvailVal);
        avail2 = createFullAvailability(res, year, availVal);
    }

    // Reset full availability for rejoined resource
    avail1 = createFullAvailability(res, year, availVal);
    avail2 = createFullAvailability(res, year + 1, availVal);

    // Save both availability records
    resourceService.addAvailability(avail1);
    resourceService.addAvailability(avail2);

    // Also reset Holiday Planner entries
    saveHolidayPlanner(res, year);
    saveHolidayPlanner(res, year + 1);

    // Add Change Log
    ChangeLog log = getChangeLog("Rejoined Resource PSID: " + res.getPsid() + " - Availability & Holidays reset");
    resourceService.addResourceLog(log);
}
