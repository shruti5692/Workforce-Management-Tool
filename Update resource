private void handleRejoin(Resource res) {
    String psid = res.getPsid();
    int currentYear = LocalDate.now().getYear();
    int nextYear = currentYear + 1;

    // üßπ STEP 1: Delete all old data for the resource
    // (old allocations, availability, holidays)
    allocationRepository.deleteAllByPsid(psid);
    availabilityRepository.deleteAllByAvailabilityCompositeId_Psid(psid);
    holidayPlannerRepository.deleteAllByHolidayPlannerCompositeId_Psid(psid);

    // üß± STEP 2: Recreate fresh availability for current + next year
    Availability availCurrent = createFullAvailability(res, currentYear, BigDecimal.ONE);
    Availability availNext = createFullAvailability(res, nextYear, BigDecimal.ONE);
    availabilityRepository.save(availCurrent);
    availabilityRepository.save(availNext);

    // üå¥ STEP 3: Recreate fresh holiday planner (set all months to 0)
    saveHolidayPlanner(res, currentYear);
    saveHolidayPlanner(res, nextYear);

    // üßë‚Äçü§ù‚Äçüßë STEP 4: Recreate team allocation only for the current team
    Allocation newAlloc = new Allocation();
    newAlloc.setPsid(psid);
    newAlloc.setTeam(res.getTeam());
    newAlloc.setStartDate(res.getStartDate());
    newAlloc.setEndDate(res.getEndDate());
    newAlloc.setAvailability(new BigDecimal("1.0"));
    allocationRepository.save(newAlloc);

    // ü™µ STEP 5: Add change log for tracking
    ChangeLog log = getChangeLog("Resource rejoined: " + psid + 
                                 ". Reset previous allocations, availability, and holidays.");
    resourceService.addResourceLog(log);
}
