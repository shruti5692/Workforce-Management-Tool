private void handleRejoin(Resource res) {
    int rejoinYear = res.getStartDate().getYear();
    int rejoinMonth = res.getStartDate().getMonthValue();

    BigDecimal one = BigDecimal.ONE;
    BigDecimal zero = BigDecimal.ZERO;

    // ✅ 1. Get previous resource data (mainly end date)
    Optional<Resource> existingRes = resourceService.findById(res.getPsid());
    LocalDate prevEndDate = existingRes.map(Resource::getEndDate).orElse(null);

    // ✅ 2. Create availability for current + next financial year
    Availability availCurr;
    Availability availNext;

    if (prevEndDate != null && prevEndDate.isBefore(res.getStartDate())) {
        // Resource had a break — mark months before rejoin as unavailable
        availCurr = createPartialAvailability(res, rejoinYear, rejoinMonth, one, zero);
        availNext = createFullAvailability(res, rejoinYear + 1, one);
    } else {
        // Normal case: fully available
        availCurr = createFullAvailability(res, rejoinYear, one);
        availNext = createFullAvailability(res, rejoinYear + 1, one);
    }

    resourceService.addAvailability(availCurr);
    resourceService.addAvailability(availNext);

    // ✅ 3. Reset holidays (reuse helper)
    saveHolidayPlanner(res, rejoinYear);
    saveHolidayPlanner(res, rejoinYear + 1);

    // ✅ 4. Log rejoin event
    ChangeLog log = getChangeLog("Resource rejoined: " + res.getPsid()
        + ", Name: " + res.getName()
        + ", Team: " + res.getTeam()
        + ", Rejoin Date: " + res.getStartDate());
    resourceService.addResourceLog(log);
}
